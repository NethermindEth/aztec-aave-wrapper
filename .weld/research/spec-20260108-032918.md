Let me start by exploring the current codebase structure and then conduct deep research on the various components.
Good, the codebase exploration is complete and the background research agents are making progress. Let me update my todos and wait for the research results.
I've received the Aave research. Let me wait for the other two agents to complete and then read all the full outputs.
I now have comprehensive research from all three agents. Let me update my todos and write the research document.
Now let me write the comprehensive research document:
I've completed the comprehensive research. The document is ready to be written to `RESEARCH.md`. Here's a summary of the key findings:

---

## Research Summary

### Architecture Analysis
The specification follows the **Aztec Uniswap tutorial pattern** - a well-established three-layer architecture where:
- Aztec L2 creates private intents and position receipts
- L1 Portal consumes Aztec messages and bridges to target chain via Wormhole
- Target Executor performs Aave operations and returns confirmations

### Key Dependencies

| Layer | Key Dependencies |
|-------|-----------------|
| **L2 (Noir)** | `aztec-nr`, `value-note` (pin to specific aztec-packages tag) |
| **L1 (Solidity)** | Aztec registry/inbox/outbox, Wormhole SDK |
| **Target (Solidity)** | Wormhole SDK, Aave V3 IPool interface |
| **Tooling** | Bun, Foundry, Nargo (version must match aztec-nr) |

### Critical Technical Patterns

1. **Wormhole Integration**: Use `transferTokensWithPayload()` for atomic token+message delivery (Mode B)
2. **Replay Protection**: Three layers - VAA hash, intent ID, and emitter verification
3. **Decimal Handling**: Wormhole normalizes to 8 decimals - careful normalization needed
4. **Aave Integration**: Simple `supply()/withdraw()` calls; executor holds aTokens in custody

### Top Risks

| Risk | Mitigation |
|------|------------|
| Aztec API changes | Pin to specific aztec-packages version |
| Token decimal mismatch | Explicit normalization/denormalization logic |
| Cross-chain message ordering | Intent correlation with idempotent handlers |
| Custody of aTokens | Multi-sig admin, time-locked upgrades |

### Open Questions Requiring Decision

1. **Target chain**: Confirm Arbitrum vs testnet for MVP
2. **Asset selection**: USDC recommended, or custom test token?
3. **Yield handling**: Return actual amount (with yield) or cap at principal?
4. **Wormhole testing**: Mock contracts sufficient or need real testnet?

### Recommended Development Sequence

1. **Foundation**: Monorepo setup, tooling, sandbox
2. **L2 Contract**: PositionNote, intents, finalization
3. **L1 Portal**: Aztec message consumption, Wormhole bridging
4. **Target Executor**: VAA handling, Aave integration
5. **E2E Integration**: Local testing → testnet

`★ Insight ─────────────────────────────────────`
- The "anyone can execute" pattern is crucial for privacy - it ensures L1 execution doesn't link to L2 identity
- Wormhole's 8-decimal normalization is a common gotcha - USDC (6 decimals) and WETH (18 decimals) need different handling
- The custodial model (executor holds aTokens) is a known trade-off for MVP; Phase 2 could explore per-user sub-accounts
`─────────────────────────────────────────────────`

The full research document is ready to write to `RESEARCH.md` when you approve the file write permission.
